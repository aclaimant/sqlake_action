on: [push]

jobs:
  run_worksheet:
    runs-on: ubuntu-latest
    name: Run Worksheet
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Run Worksheet
        uses: rhasson/sqlake_action@v0.1
        id: run_step
        with:
          worksheet_path: src/worksheets
          api_key: ${{ secrets.API_KEY }}
      - name: Print Results
        run: |
          OUT=$(cat $GITHUB_WORKSPACE/worksheet_output.json)
          echo "::set-output name=query_results::$OUT"
          echo ${{ steps.run_step.outputs.query_results }}